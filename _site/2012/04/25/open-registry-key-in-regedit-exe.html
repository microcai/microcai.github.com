<!DOCTYPE html>
<html>
  <head>
    <title>Open registry key in regedit.exe - Litao.Me</title>
    <link rel="shortcut icon" href="favicon.ico" />
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" media="screen" href="/stylesheets/screen.css" type="text/css" />
    <link rel="stylesheet" href="/stylesheets/embed.css"/>
    
    
  </head>
  <body>
    <div id="page">
      <div id="header">
        <a href="/"><h1>Litao.Me</h1></a>
      </div>
      <div id="body">
        <h1>Open registry key in regedit.exe</h1>
        <div class="postdate">Posted on 25 Apr 2012</div>
<div class="post">
<p><strong>Usage: regjump.exe HKEY_LOCAL_MACHINE\SOFTWARE</strong></p>

<div id="gist-3747786" class="gist">
        <div class="gist-file">
          <div class="gist-data gist-syntax">
              <div class="gist-highlight"><pre><div class="line" id="LC1"><span class="n">BOOL</span> <span class="nf">TerminateProcessByPid</span><span class="p">(</span><span class="n">DWORD</span> <span class="n">Pid</span><span class="p">)</span></div><div class="line" id="LC2"><span class="p">{</span></div><div class="line" id="LC3">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">BOOL</span> <span class="n">Result</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span></div><div class="line" id="LC4">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">HANDLE</span> <span class="n">ProcessHandle</span> <span class="o">=</span> <span class="n">OpenProcess</span><span class="p">(</span><span class="n">PROCESS_ALL_ACCESS</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">Pid</span><span class="p">);</span></div><div class="line" id="LC5">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="n">ProcessHandle</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span></div><div class="line" id="LC6">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line" id="LC7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Result</span> <span class="o">=</span> <span class="n">TerminateProcess</span><span class="p">(</span><span class="n">ProcessHandle</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span></div><div class="line" id="LC8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">CloseHandle</span><span class="p">(</span><span class="n">ProcessHandle</span><span class="p">);</span></div><div class="line" id="LC9">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC10"><br></div><div class="line" id="LC11">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">Result</span><span class="p">;</span></div><div class="line" id="LC12"><span class="p">}</span></div><div class="line" id="LC13"><br></div><div class="line" id="LC14"><span class="n">BOOL</span> <span class="nf">TerminateProcessByName</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">basic_string</span><span class="o">&lt;</span><span class="n">TCHAR</span><span class="o">&gt;&amp;</span> <span class="n">Name</span><span class="p">)</span></div><div class="line" id="LC15"><span class="p">{</span></div><div class="line" id="LC16">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">HANDLE</span> <span class="n">SnapShot</span> <span class="o">=</span> <span class="n">CreateToolhelp32Snapshot</span><span class="p">(</span><span class="n">TH32CS_SNAPPROCESS</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span></div><div class="line" id="LC17">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="n">SnapShot</span> <span class="o">==</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span></div><div class="line" id="LC18">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="mi">0</span><span class="p">;</span></div><div class="line" id="LC19"><br></div><div class="line" id="LC20">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">PROCESSENTRY32</span> <span class="n">ProcessEntry</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span></div><div class="line" id="LC21">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">ProcessEntry</span><span class="p">.</span><span class="n">dwSize</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PROCESSENTRY32</span><span class="p">);</span></div><div class="line" id="LC22">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Process32First</span><span class="p">(</span><span class="n">SnapShot</span><span class="p">,</span><span class="o">&amp;</span><span class="n">ProcessEntry</span><span class="p">))</span></div><div class="line" id="LC23">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line" id="LC24">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">CloseHandle</span><span class="p">(</span><span class="n">SnapShot</span><span class="p">);</span></div><div class="line" id="LC25">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="mi">0</span><span class="p">;</span></div><div class="line" id="LC26">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC27"><br></div><div class="line" id="LC28">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">DWORD</span> <span class="n">Pid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></div><div class="line" id="LC29"><br></div><div class="line" id="LC30">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">do</span></div><div class="line" id="LC31">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line" id="LC32">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="n">ProcessEntry</span><span class="p">.</span><span class="n">th32ProcessID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span></div><div class="line" id="LC33">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line" id="LC34">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">continue</span><span class="p">;</span></div><div class="line" id="LC35">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC36"><br></div><div class="line" id="LC37">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="n">ustd</span><span class="o">::</span><span class="n">CompareStringNoCase</span><span class="o">&lt;</span><span class="n">TCHAR</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ProcessEntry</span><span class="p">.</span><span class="n">szExeFile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span></div><div class="line" id="LC38">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line" id="LC39">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Pid</span> <span class="o">=</span> <span class="n">ProcessEntry</span><span class="p">.</span><span class="n">th32ProcessID</span><span class="p">;</span></div><div class="line" id="LC40">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">break</span><span class="p">;</span></div><div class="line" id="LC41">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC42"><br></div><div class="line" id="LC43">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">Process32Next</span><span class="p">(</span><span class="n">SnapShot</span><span class="p">,</span><span class="o">&amp;</span><span class="n">ProcessEntry</span><span class="p">));</span></div><div class="line" id="LC44"><br></div><div class="line" id="LC45">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">CloseHandle</span><span class="p">(</span><span class="n">SnapShot</span><span class="p">);</span></div><div class="line" id="LC46"><br></div><div class="line" id="LC47">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="n">TerminateProcessByPid</span><span class="p">(</span><span class="n">Pid</span><span class="p">);</span></div><div class="line" id="LC48"><span class="p">}</span></div><div class="line" id="LC49"><br></div><div class="line" id="LC50"><span class="n">bool</span> <span class="nf">AdjustPrivileges</span><span class="p">(</span><span class="k">const</span> <span class="n">TString</span><span class="o">&amp;</span> <span class="n">Name</span><span class="p">,</span><span class="n">bool</span> <span class="n">IsRemove</span><span class="p">)</span></div><div class="line" id="LC51"><span class="p">{</span></div><div class="line" id="LC52">   <span class="n">HANDLE</span> <span class="n">TokenHandle</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span></div><div class="line" id="LC53">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">OpenProcessToken</span><span class="p">(</span><span class="n">GetCurrentProcess</span><span class="p">(),</span><span class="n">TOKEN_ALL_ACCESS</span><span class="p">,</span><span class="o">&amp;</span><span class="n">TokenHandle</span><span class="p">))</span></div><div class="line" id="LC54"> <span class="p">{</span></div><div class="line" id="LC55">      <span class="k">return</span> <span class="nb">false</span><span class="p">;</span></div><div class="line" id="LC56">   <span class="p">}</span></div><div class="line" id="LC57"><br></div><div class="line" id="LC58">    <span class="n">TOKEN_PRIVILEGES</span> <span class="n">TokenPrivileges</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span></div><div class="line" id="LC59">    <span class="n">LookupPrivilegeValue</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="n">Name</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="o">&amp;</span><span class="n">TokenPrivileges</span><span class="p">.</span><span class="n">Privileges</span><span class="o">-&gt;</span><span class="n">Luid</span><span class="p">);</span></div><div class="line" id="LC60"><br></div><div class="line" id="LC61"> <span class="n">TokenPrivileges</span><span class="p">.</span><span class="n">PrivilegeCount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></div><div class="line" id="LC62">    <span class="n">TokenPrivileges</span><span class="p">.</span><span class="n">Privileges</span><span class="o">-&gt;</span><span class="n">Attributes</span> <span class="o">=</span> <span class="n">IsRemove</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">SE_PRIVILEGE_ENABLED</span><span class="p">;</span></div><div class="line" id="LC63"> <span class="k">if</span> <span class="p">(</span><span class="n">AdjustTokenPrivileges</span><span class="p">(</span><span class="n">TokenHandle</span><span class="p">,</span><span class="n">FALSE</span><span class="p">,</span><span class="o">&amp;</span><span class="n">TokenPrivileges</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">TOKEN_PRIVILEGES</span><span class="p">),</span><span class="nb">NULL</span><span class="p">,</span><span class="nb">NULL</span><span class="p">))</span></div><div class="line" id="LC64">  <span class="p">{</span></div><div class="line" id="LC65">      <span class="n">CloseHandle</span><span class="p">(</span><span class="n">TokenHandle</span><span class="p">);</span></div><div class="line" id="LC66">     <span class="k">return</span> <span class="nb">true</span><span class="p">;</span></div><div class="line" id="LC67">    <span class="p">}</span></div><div class="line" id="LC68"><br></div><div class="line" id="LC69">    <span class="n">CloseHandle</span><span class="p">(</span><span class="n">TokenHandle</span><span class="p">);</span></div><div class="line" id="LC70"> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span></div><div class="line" id="LC71"><span class="p">}</span></div><div class="line" id="LC72"><br></div><div class="line" id="LC73"><span class="kt">void</span> <span class="nf">testOpenReg</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">TCHAR</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span></div><div class="line" id="LC74"><span class="p">{</span></div><div class="line" id="LC75">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span></div><div class="line" id="LC76">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span><span class="p">;</span></div><div class="line" id="LC77"><br></div><div class="line" id="LC78">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">AdjustPrivileges</span><span class="p">(</span><span class="n">SE_DEBUG_NAME</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span></div><div class="line" id="LC79"><br></div><div class="line" id="LC80">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">TerminateProcessByName</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"Regedit.exe"</span><span class="p">));</span></div><div class="line" id="LC81"><br></div><div class="line" id="LC82">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">std</span><span class="o">::</span><span class="n">basic_string</span><span class="o">&lt;</span><span class="n">TCHAR</span><span class="o">&gt;</span> <span class="n">TargetKey</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span></div><div class="line" id="LC83">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">HKEY</span> <span class="n">KeyHandle</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span></div><div class="line" id="LC84">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">DWORD</span> <span class="n">Disposition</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></div><div class="line" id="LC85">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">LONG</span> <span class="n">Result</span> <span class="o">=</span> <span class="n">RegCreateKeyEx</span><span class="p">(</span><span class="n">HKEY_CURRENT_USER</span><span class="p">,</span></div><div class="line" id="LC86">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">_T</span><span class="p">(</span><span class="s">"Software</span><span class="se">\\</span><span class="s">Microsoft</span><span class="se">\\</span><span class="s">Windows</span><span class="se">\\</span><span class="s">CurrentVersion</span><span class="se">\\</span><span class="s">Applets</span><span class="se">\\</span><span class="s">Regedit"</span><span class="p">),</span></div><div class="line" id="LC87">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="mi">0</span><span class="p">,</span></div><div class="line" id="LC88">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">NULL</span><span class="p">,</span></div><div class="line" id="LC89">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">REG_OPTION_NON_VOLATILE</span><span class="p">,</span></div><div class="line" id="LC90">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">KEY_ALL_ACCESS</span><span class="p">,</span></div><div class="line" id="LC91">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">NULL</span><span class="p">,</span></div><div class="line" id="LC92">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">&amp;</span><span class="n">KeyHandle</span><span class="p">,</span></div><div class="line" id="LC93">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">&amp;</span><span class="n">Disposition</span><span class="p">);</span></div><div class="line" id="LC94">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span> <span class="p">(</span><span class="n">Result</span> <span class="o">==</span> <span class="n">ERROR_SUCCESS</span><span class="p">)</span></div><div class="line" id="LC95">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span></div><div class="line" id="LC96">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">TargetKey</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">_T</span><span class="p">(</span><span class="s">"计算机</span><span class="se">\\</span><span class="s">"</span><span class="p">));</span></div><div class="line" id="LC97">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">RegSetValueEx</span><span class="p">(</span><span class="n">KeyHandle</span><span class="p">,</span> </div><div class="line" id="LC98">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">_T</span><span class="p">(</span><span class="s">"LastKey"</span><span class="p">),</span> </div><div class="line" id="LC99">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nb">NULL</span><span class="p">,</span> </div><div class="line" id="LC100">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">REG_SZ</span><span class="p">,</span> </div><div class="line" id="LC101">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">(</span><span class="n">CONST</span> <span class="n">BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">TargetKey</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> </div><div class="line" id="LC102">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">TargetKey</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">TCHAR</span><span class="p">));</span></div><div class="line" id="LC103">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">RegCloseKey</span><span class="p">(</span><span class="n">KeyHandle</span><span class="p">);</span></div><div class="line" id="LC104">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC105"><br></div><div class="line" id="LC106">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">ShellExecute</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">_T</span><span class="p">(</span><span class="s">"Regedit.exe"</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">SW_SHOW</span><span class="p">);</span></div><div class="line" id="LC107"><br></div><div class="line" id="LC108">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span><span class="p">;</span></div><div class="line" id="LC109"><span class="p">}</span></div><div class="line" id="LC110"><br></div><div class="line" id="LC111"><span class="kt">int</span> <span class="nf">_tmain</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="n">TCHAR</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span></div><div class="line" id="LC112"><span class="p">{</span></div><div class="line" id="LC113">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">testOpenReg</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span></div><div class="line" id="LC114">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="mi">1</span><span class="p">;</span></div><div class="line" id="LC115"><span class="p">}</span></div><div class="line" id="LC116"><br></div></pre></div>
          </div>

          <div class="gist-meta">
            <a href="https://gist.github.com/raw/3747786/069c22f4c41f086a74d1c1558dac1edee3cd0b48/open_registry.c" style="float:right;">view raw</a>
            <a href="https://gist.github.com/3747786#file_open_registry.c" style="float:right;margin-right:10px;color:#666">open_registry.c</a>
            <a href="https://gist.github.com/3747786">This Gist</a> brought to you by <a href="http://github.com">GitHub</a>.
          </div>
        </div>
</div>


</div>
 
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>27 Sep 2012</span> - <a href="/2012/09/27/iocp.html">IOCP Internals</a></li>
    
      <li><span>16 Sep 2012</span> - <a href="/2012/09/16/begin.html">新的开始</a></li>
    
      <li><span>23 Apr 2012</span> - <a href="/2012/04/23/How-to-Get-Network-Change-automation.html">如何自动获取网络变化通知</a></li>
    
      <li><span>19 Apr 2012</span> - <a href="/2012/04/19/analyze-dead-lock.html">一次死锁的分析</a></li>
    
      <li><span>05 Mar 2012</span> - <a href="/2012/03/05/use_declspec_thread_in_dll.html">Use __declspec(thread) in dll occured Exception</a></li>
    
  </ul>
</div>


<br />
<br />
<hr />
<div id="comments">
  <h2>Comments</h2>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_identifier = "/2012/04/25/open-registry-key-in-regedit-exe.html";
    (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = 'http://eahydra.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=eahydra">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

      </div>
    </div>
  </body>
</html>
